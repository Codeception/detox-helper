language: node_js
node_js: 8

matrix:
  include:
  - language: objective-c
    os: osx
    osx_image: xcode10.2
    env:
    - REACT_NATIVE_VERSION=0.59.4
      PATH=$PATH:~/Library/Python/2.7/bin
    install:
    - npm install -g react-native-cli 
    - npm install -g detox-cli
    - export CODE_SIGNING_REQUIRED=NO
    - brew tap wix/brew
    - brew install applesimutils --HEAD
    - cd test
    - npm install        
    - detox build --configuration ios.sim.release
    script:
    - detox test --configuration ios.sim.release --debug-synchronization

  - language: android
    env:
    - REACT_NATIVE_VERSION=0.59.4
    android:
    components:
    - tools
    - platform-tools
    - build-tools-27.0.3
    - android-26
    - extra-google-google_play_services
    - extra-google-m2repository
    - extra-android-m2repository
    - sys-img-x86-android-26
    - sys-img-x86-android-28
    before_install:
    - yes | sdkmanager "platforms;android-28"    
    install:
    - npm install -g react-native-cli 
    - npm install -g detox-cli
    - cd test
    - npm install    
    - detox build --configuration android.emu.release
    script:
    - detox test --configuration android.emu.release


before_install:
- nvm install 10
